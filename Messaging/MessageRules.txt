Messaging Protocol for the ssl log escrow server running rabbitMQ:

1. All messages are passed to other agents depending on the 'recipientID'
   specified in the call to 'sendMessages' in MessageWrapper.py

2. Messages to escrow only must have recipient ID: "escrow"

3. Messages to both must have "counterpartyID.escrow" 

4. Messages to counterparty only must have "counterpartyID"

5. Each message in the dict messages is of form {'topic':'message'}

6. The 'topic' field will contain <the ID of the transaction>.<the ID of the sender>

6a. In case no transaction is specified in the message, the transaction ID can be replaced by '0' in (6).

7. The 'message' will be a string of text which will be interpreted by the other agent.

8. The 'message' will have a format MSGTYPE:data,data,data,....

9. If the message is not one of [TRANSACTION_SYNC_REQUEST,TRANSACTION_SYNC_RESPONSE,TRANSACTION_SYNC_COMPLETE], then the first data item in (8) MUST be a new transaction state (in case of message TO escrow, this is a request which may or may not be agreed to; in case of message FROM escrow, this is a confirmation/statement of fact).

10. List of MSGTYPES:
REQUEST_REJECTED - data are:reason
CLIENT_ALIVE_REQUEST - data are: none
CLIENT_ALIVE_RESPONSE - data are: none
CLIENT_LOGON - data are: none
CLIENT_LOGOUT - (unused)
TRANSACTION_SYNC_REQUEST - data are: none
TRANSACTION_SYNC_RESPONSE - data are: string in pickle format
TRANSACTION_SYNC_COMPLETE - data are: none
TRANSACTION_REQUEST - data are: buyerID,sellerID,amount,price,currency
TRANSACTION_ACCEPT - data are: buyerID,sellerID,amount,price,currency,creation time
CLIENT_TALK - data are: text message to counterparty
TRANSACTION_REJECT - data are: reason
TRANSACTION_ABORT - no data
TRANSACTION_ABORT_ACCEPTED - no data
TRANSACTION_ABORT_REJECTED - data are: reason
BANK_SESSION_START_REQUEST - no data
BANK_SESSION_START_READY - no data
BANK_SESSION_START_ACCEPTED - no data
BANK_SESSION_START_REJECTED - data are: reason
BANK_SESSION_ENDED - data are: y/n (indicates success or failure)
BANK_SESSION_ABORT - no data
DISPUTE_L1_REQUEST - data are: reason for request,..
SSL_DATA_REQUEST - data are: no data
SSL_DATA_SEND - data are: hash1,hash2,..
SSL_DATA_RECEIVED - data are: none
SSL_DATA_REJECTED - data are: none
DISPUTE_L1_ADJUDICATION_FAILURE - data are: reason for failure
DISPUTE_L1_ADJUDICATION - data are: agent awarded to, reason for award
DISPUTE_L2_REQUEST_SSL_KEYS - data are: none
DISPUTE_L2_SEND_SSL_KEYS - data are: [CLIENT RANDOM/RSA],random,master secret,..
DISPUTE_L2_SEND_HTML_EVIDENCE - data are: html src, html src,...
TRANSACTION_SUCCESS_REQUEST - data are: none
TRANSACTION_SUCCESS_REQUEST_ACCEPTED - data are: none
<TBC>
